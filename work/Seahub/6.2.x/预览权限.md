## 需求
 
分享的时候添加预览权限

## 需求点

- [√] 分享的时候多一个预览权限(包括显示、修改、删除操作)
- [√] 分享的管理页面对于预览权限可以正常显示，可以修改， 删除。
- [ ] 点开预览权限的资料库的时候，对于每个文件(没特殊设置过用户权限的)只显示评论和详细信息按钮(如果用户权限和群组权限冲突，则用户权限优先，否则取最大的权限)
- [√] 权限的审计对于预览权限可以正常显示
- [ ] api[下载、共享]部分权限判断(那些只读可以做的，但是预览不可以做的)

## 设计

解决资料库权限冲突:  

	在每次共享给用户的时候，完全记录用户权限.(对于r、rw的作用只是为了填充如果共享的是r、rw权限的时候表的空白，这个r、rw并没有实际意义)
	在每次共享给群组的时候，还是只记录额外的权限(admin、preview).

	查询用户对某个资料库的权限的时候会去除r、rw的记录,按照原来的逻辑(查询底层权限，如果seahub层有权限，则会进行替换)执行.

获得某个文件权限:
- 首先判断用户表是否有对应的preview的记录，如果有而且底层为r权限，则直接返回预览权限.
- 判断用户表是否有记录，有的话直接返回底层记录的权限.
- 如果用户表没有记录，则判断用户群组表是否有preview权限，如果群组表有对应记录，而且底层为r权限，则返回预览权限，如果群组表没有对应数据则返回底层权限.

## 问题

无法细化到每个文件夹

比如: 分享一个资料库给a仅预览权限，然后设置资料库内某个文件夹对a的权限为只读，这样子无法判断这个文件夹的权限。